<p align="center">
  <img src="./img/logo.png" width="120">
</p>

## ES最佳实践
凝聚ERP高级开发实践经验和持续成果的免费项目——ESAP服务器，来自村长的倾情奉献!

#### [快速开始](s0.md)

##### 最新版本
* <a href="./build/esap2.8_freedom_beta4.rar" target="_blank">v2.8 freedom beta4</a><span style="color:red"> new!</span>

##### 其他版本
* <a href="./build/esap2.7destiny_x86.rar" target="_blank">v2.7destiny正式版x86</a>

* <a href="./build/esap2.7destiny_x64.rar" target="_blank">v2.7destiny正式版x64</a>

##### 文档&需求

* 详细文档PDF版（by @淡淡风）：<a href="/build/ESAP微信版部署教程.pdf" target="_blank">ESAP微信版部署教程</a> <span style="color:red">new!</span>

* 欢迎提需求，[玩家需求实现进度](ref.md)

##### 示例数据库

* <a href="./db/esap2.0.rar" target="_blank">v2.7destiny</a>

> ES 9.4.124; SQLSERVER 2008R2

#### 捐赠
维护这个项目需要大量时间和精力，如果它确实帮上了你的忙，不要忘了请我喝杯茶哦 :)

<p align="center">
  <img src="./img/esap_pay.png" width="400">
</p>

#### ESAP部落微信公众号
关注公众号，及时掌握最新动态 => ESAPbuluo ↓↓↓

<p align="center">
  <img src="./img/wx.jpg" width="240">
</p>

<hr />

#### 更新日志

##### v2.8 freedom!
公测中^_^

* [新增]微信查询的结果无字段名称时，将省略名称和冒号，实现更灵活的输出。
* [新增]微信查询进入提醒可写sql，实现灵活的提醒功能，需配置showfunclistenter=true。<span style="color:red">玩家需求!</span>
* [调整]更换数据库驱动，全面支持多重select查询新特性，数据库要求sql2005+！<span style="color:red"> 重大调整!</span>
* [新增]新增微信会话回调（/wxchat），可存储企业号会话消息。<span style="color:red">玩家需求!</span>
* [新增]新增api2/*接口，带错误输出(errmsg)和结果输出(output)。<span style="color:red">玩家需求!</span>
* [新增]app新增ES绑定账号。
* [新增]微信办理增加多帐套支持，wxtx,wxcx表加入了db字段，填入对应数据库名称即可。<span style="color:red">玩家需求!</span>
* [新增]集成nssm和一键安装，卸载自动化批处理文件。
* [新增]sql模板新增uuid函数，用来产生不重复全局唯一ID。
* [调整]调整api/*接口，post/put/delete自带事务。
* [调整]配置文件格式调整为yaml，名称调整为esap.yml。解决配置(如密码)中包`'`号等特殊字符不识别问题。
* [修复]更新wxtx.tpl，修复微信提醒加入top100后不能发提醒的bug。

##### v2.7 destiny
发布于`2017-5-9`

* [新增]新增WxqdTitle配置项，用于配置微信签到显示标题。
* [新增]新增upload接口，用于上传图片文件。
* [新增]微信查询新增P参数，表示输入的所有内容。
* [新增]新增计划任务模块(全新的玩法，更多的脑洞)；<span style="color:red">玩家需求!</span>
* [新增]微信查询新增多重返回，可以一次写多个select，保证返回的字段数量一致即可；
* [新增]新增若干开关，可手工更改EsConf配置文件进行调整；
* [新增]微信查询新增默认应用支持(全新的玩法，更多的脑洞)；<span style="color:red">玩家需求!</span>
* [新增]新增log模块，运行日志写入esap.log文件，上次日志存入日志备份(esap.log.bak)，当配置Debug=false时，将不再打印sql模板相关信息，可大幅减小日志文件体积；
* [新增]微信提醒增加重发机制(配置文件ReTryMsg=true)，海外用户应用时更稳定；<span style="color:red">玩家需求!</span>
* [新增]微信提醒“部门/职位”格式的接收人支持；<span style="color:red">玩家需求!</span>
* [调整]微信提醒接收人填报更自由，可使用姓名，账号，手机号，微信号，邮箱，职位，部门任意组合搭配；
* [新增]支持保密消息(safe=1)；<span style="color:red">玩家需求!</span>
* [新增]ESWEB待办事宜列表打开；
* [新增]超级查询新增用户进入时显示可用查询列表(配置ShowFuncListEnter=true)，企业号端需开启`上报用户进入`，此外配置文件ShowFuncList=true时，查询中未匹配任何功能也会返回可用查询列表；
* [新增]超级查询新增ES表单搜索查看功能；
* [新增]超级查询增加打包回复模式，解决消息内容过多时的乱序问题（mediaOnly=3）；
* [新增]HOST配置支持端口，可以与监听端口(例如9090)不一致，更方便外网NAT；
* [新增]微信权限支持自定义角色权限支持；
* [新增]esmail自定义发件人支持,可不使用系统Email账户,但与系统Email共用smtp服务器设置；<span style="color:red">玩家需求!</span>
* [调整]调整微信提醒，邮件提醒，使用计划任务进行配置；
* [调整]调整微信反馈，增加附件上传与回复；
* [调整]超级查询优化消息机制，改善网络延迟造成的重发问题；
* [调整]采用vux重写app；
* [调整]采用sqlt重写esmail插件、微信提醒插件、超级查询和api模块等，支持自定义sql模板；
* [调整]取消`微信通讯录`模板，改为服务器缓存，解决重名和同步等烦恼；
* [调整]重构ESAP主容器，采用模块化+插件化架构，适应大规模开发定制应用；
* [修复]中文消息超过500字时拆分出空消息的bug；

##### v2.5 里程碑
发布于`2017-3-8`

* [新增]新增微信签到，支持地图显示，支持菜单按钮签到；
* [新增]新增微信图库，通过相册或拍摄照片上传，支持多图上传；
* [新增]新增微信反馈，通过APP进行反馈提交；
* [新增]微信提醒新增图片、文件消息支持；
* [新增]微信提醒新增多人多部门消息支持；
* [新增]微信提醒新增密图文消息支持，支持多条密图文；
* [新增]微信提醒新增普通新闻消息支持，支持多条普通新闻；
* [新增]微信超级查询新增回写支持，支持update,insert；
* [新增]微信超级查询新增通讯录变量支持，增加任意标点分割功能；
* [新增]微信超级查询新增多选混合权限支持；
* [新增]微信超级查询新增任意应用回调支持；
* [新增]微信超级查询新增扫码(二维码/条码)查询支持；
* [新增]微信超级查询新增图片，附件查询支持；
* [新增]微信超级查询新增OCR接口；
* [新增]微信超级查询增加自动拆分消息功能(500字)；
* [新增]微信超级查询增加填报功能； <span style="color:red">plus!</span>
* [新增]增强办理链接加密级别； <span style="color:red">plus!</span>
* [新增]增强微信图库兼容级别； <span style="color:red">plus!</span>
* [调整]采用echo框架重构公共库。
* [修复]超级查询随机排序问题；

##### v2.4 plus
发布于`2017-2-4`

* [新增]新增微信超级查询引擎；
* [新增]新增API主机(Host),ESweb主机配置项；
* [新增]新增工作流办理； <span style="color:red">plus!</span>
* [调整]采用重构版微信SDK。 <span style="color:red">plus!</span>

##### v2.3
发布于`2017-1-18`

* [新增]新增微信提醒标题配置项；  
* [新增]新增邮件提醒功能，可带图片、附件；  
* [修复]高版本网盘系统表切换问题。

##### v2.2
发布于`2017-1-13`

* 简化配置项，增加配置页面/conf；  
* 更新大量细节，模块运行更稳定；
* 错误提示完善，不再因普通错误导致崩溃；  
* 现在你只需要两步就可以玩转微信提醒： **1、导入模板；2、启动esap.exe** 就是这么简单！

##### v2.1
发布于`2017-1-7`

* 修复BOM复制本表代码；  
* 更新vBOM、vPBOM视图，修复子件超过10个的RN排序问题；  
* 导入微信提醒、微信通讯录、微信提醒视图(vwxtx)；    
* 增加微信企业号API及基本配置； 

##### v2.0 
发布于`2017-1-5`

* 导入主数据：商品、企业、字典；  
* 导入IO单对象、订单对象；  
* 导入无级BOM；  
* 导入自动检查更新功能(ESAP_关于)。
